
version: 1
task_definition:
  ecs_network_mode: awsvpc
  task_role_arn: arn:aws:iam::802019692967:role/flu.default.task.role
  task_execution_role: arn:aws:iam::802019692967:role/flu.default.task.execution.role
  task_size:
    cpu_limit: 256
    mem_limit: 512
  services:
    fluidity-money-app:
      essential: true
      secrets:
        - name: FLU_SENTRY_URL
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/sentryUrl
        - name: FLU_FRONTEND_SENTRY_URL
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/frontend/sentryURL
        - name: FLU_NPM_GITHUB_TOKEN
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/npm/github_token
        - name: BITQUERY_TOKEN
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/bitquery_token
        - name: FLU_ETH_RPC_HTTP
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/ethereum/http_url
        - name: FLU_ETH_RPC_WS
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/ethereum/websocket_url
        - name: FLU_SOL_RPC_HTTP
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/solana/http_url
        - name: FLU_SOL_RPC_WS
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/solana/websocket_url
        - name: FLU_HASURA_HTTP
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/hasura/rpc_http
        - name: FLU_HASURA_WS
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/hasura/rpc_ws
        - name: FLU_HASURA_SECRET
          value_from: arn:aws:ssm:ap-southeast-2:802019692967:parameter/fluidity/hasura/key

      
run_params:
  task_placement:
    strategy:
      - type: spread
        field: attribute:ecs.availability-zone
  network_configuration:
    awsvpc_configuration:
      subnets:
        - subnet-0da97e2bef4bbcaf9
        - subnet-09292973d45046c54
        - subnet-0560b1a24283301ac
      security_groups:
        - sg-0190855874db0065a
      assign_public_ip: ENABLED